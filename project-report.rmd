---
title: "Group project assessment [template]"
author: '[update with group members'' exam numbers]'
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

NOTE: Please don't edit this template directly. Use `File` > `Save as` to create a copy of this document, rename it (remove the word "template" from the file name) and use that new version to write your report. Make sure to also update the Title and Author fields in the YAML of your .Rmd file.

## Task 1: Reproducing and improving figures

```{r load-wrangle}
# load and wrangle the data here

library(tidyverse)
library(here)
library(janitor)

postpartum_depression <- read_csv(here("data", "HIIT-postpartum-depression.csv")) %>% 
  clean_names()

postpartum_depression[postpartum_depression == "#NULL!"] <- NA
```


### Figure 3
```{r figure-3}
# Write your code for reproducing, and then improving Figure 3. Present both figures together. Under the figures, explain how you've improved Figure 3 and why you consider this an improvement.
```


### Figure 4
```{r figure-4}
# Write your code for reproducing, and then improving Figure 4. Present both figures together. Under the figures, explain how you've improved Figure 4 and why you consider this an improvement.

# Tidy table for graph
psych_wellbeing <- postpartum_depression %>% 
  select(intervention_group, pre_fs_scale, post_fs_score, postnatal_florishing_scale_score) %>% 
  mutate(
    # Convert intervention_group before pivoting
    intervention_group = case_when(
      intervention_group == 1 | intervention_group == "1" | intervention_group == "HIIT" ~ "HIIT",
      intervention_group == 2 | intervention_group == "2" | intervention_group == "EDU" ~ "EDU",
      TRUE ~ as.character(intervention_group)
    ),
    pre_fs_scale = as.numeric(pre_fs_scale),
    post_fs_score = as.numeric(post_fs_score),
    postnatal_florishing_scale_score = as.numeric(postnatal_florishing_scale_score)
  ) %>% 
  pivot_longer(
    cols = c(pre_fs_scale, post_fs_score, postnatal_florishing_scale_score),
    names_to = "time",
    values_to = "fs_score"
  )

# Create summary statistics for plotting
psych_summary <- psych_wellbeing %>% 
  group_by(intervention_group, time) %>% 
  summarise(
    mean = mean(fs_score, na.rm = TRUE),
    sd = sd(fs_score, na.rm = TRUE),
    n = n(),
    se = sd / sqrt(n),
    .groups = "drop"
  ) %>% 
  mutate(
    # Fix the factor levels and labels to match the order
    time = factor(time, 
                  levels = c("pre_fs_scale", "post_fs_score", "postnatal_florishing_scale_score"),
                  labels = c("Before the intervention\n(II trimester of pregnancy)", 
                             "After the intervention\n(III trimester of pregnancy)", 
                             "Follow-up\n(± 5 months postpartum)"))
  )

# Create graph
ggplot(psych_summary, aes(x = time, y = mean, group = intervention_group)) +
  geom_line(aes(linetype = intervention_group), linewidth = 0.8) +
  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd), 
                width = 0.08, linewidth = 0.5) +
  geom_text(aes(label = paste0("M = ", round(mean, 2)),
                hjust = ifelse(intervention_group == "HIIT", -0.15, 1.15)),
            vjust = -0.5, size = 3.2) +
  scale_linetype_manual(
    values = c("HIIT" = "solid", "EDU" = "dashed"),
    labels = c("HIIT – High Intensity Interval Training Group", 
               "EDU – Educational Intervention Group")
  ) +
  labs(
    x = "Psychological well-being (measured with the Flourishing Scale)",
    y = "",
    linetype = ""
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.text = element_text(size = 9.5),
    legend.key.width = unit(1.5, "cm"),
    plot.margin = margin(20, 20, 20, 20),
    axis.text.x = element_text(size = 9),
    axis.text.y = element_text(size = 9),
    axis.title.x = element_text(size = 10, margin = margin(t = 10)),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_line(color = "gray90")
  ) +
  scale_y_continuous( # Adjust y-axis scales
    limits = c(40, 60), 
    breaks = seq(40, 60, 2),
    labels = sprintf("%.2f", seq(40, 60, 2))
  )

# Enhanced graph
ggplot(psych_summary, aes(x = time, y = mean, group = intervention_group)) +
  geom_line(aes(linetype = intervention_group), linewidth = 0.8) +
  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd, colour = intervention_group), 
                width = 0.08, linewidth = 0.5) +
  geom_text(aes(label = paste0("M = ", round(mean, 2)),
                hjust = ifelse(intervention_group == "HIIT", -0.15, 1.15)),
            vjust = -0.5, size = 3.2) +
  scale_linetype_manual(
    values = c("HIIT" = "solid", "EDU" = "dashed"),
    labels = c("HIIT – High Intensity Interval Training Group", 
               "EDU – Educational Intervention Group")
  ) +
  labs(
    x = "Psychological well-being (measured with the Flourishing Scale)",
    y = "",
    linetype = ""
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.text = element_text(size = 9.5),
    legend.key.width = unit(1.5, "cm"),
    plot.margin = margin(20, 20, 20, 20),
    axis.text.x = element_text(size = 9),
    axis.text.y = element_text(size = 9),
    axis.title.x = element_text(size = 10, margin = margin(t = 10)),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_line(color = "gray90")
  ) +
  scale_y_continuous( # Adjust y-axis scales
    limits = c(40, 60), 
    breaks = seq(40, 60, 2),
    labels = sprintf("%.2f", seq(40, 60, 2))
  )
```


### Figure 5
```{r figure-5}
# Write your code for reproducing, and then improving Figure 5. Present both figures together. Under the figures, explain how you've improved Figure 5 and why you consider this an improvement.
```


## Task 2: FAIR data principles

## Task 3: Reproducibility brief
