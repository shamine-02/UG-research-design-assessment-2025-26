---
title: "Group project assessment [template]"
author: '[update with group members'' exam numbers]'
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

NOTE: Please don't edit this template directly. Use `File` > `Save as` to create a copy of this document, rename it (remove the word "template" from the file name) and use that new version to write your report. Make sure to also update the Title and Author fields in the YAML of your .Rmd file.

## Task 1: Reproducing and improving figures

```{r load-wrangle}
# load and wrangle the data here
library(tidyverse)
library(here)
library(patchwork)
library(janitor)

postpartum_depression <- read.csv(here("data", "HIIT-postpartum-depression.csv")) %>% 
  clean_names() %>% 
  mutate(across(where(is.character), ~ na_if(., "#NULL!")))


```


### Figure 3
```{r figure-3}
# Write your code for reproducing, and then improving Figure 3. Present both figures together. Under the figures, explain how you've improved Figure 3 and why you consider this an improvement.
```


### Figure 4
```{r figure-4}
# Write your code for reproducing, and then improving Figure 4. Present both figures together. Under the figures, explain how you've improved Figure 4 and why you consider this an improvement.
```


### Figure 5
```{r figure-5}
figure_5_data <- postpartum_depression %>% 
  select(intervention_group, pre_sf_12_pcs_physicalhealthscale, post_sf12_pcs, postnatal_sf_12_pcs) %>%
 drop_na() %>% 
  group_by(intervention_group) %>% 
  summarise(mean_pre = mean(pre_sf_12_pcs_physicalhealthscale),
            mean_post = mean(as.numeric(post_sf12_pcs)),
            mean_postnatal = mean(as.numeric(postnatal_sf_12_pcs)),
            sd_pre = sd(pre_sf_12_pcs_physicalhealthscale),
            sd_post = sd(as.numeric(post_sf12_pcs)),
            sd_postnatal = sd(as.numeric(postnatal_sf_12_pcs))) %>% 
  pivot_longer(cols = -intervention_group,
               names_to = c("statistic", "timepoint"),
               names_sep = "_",
               values_to = "value") %>% 
  pivot_wider(names_from = statistic,
              values_from = value) %>% 
  mutate(timepoint = factor(timepoint, levels = c("pre", "post", "postnatal"))) %>% 
  mutate(intervention_group = factor(intervention_group))

figure_5_graph_original <- figure_5_data %>% 
  ggplot(aes(x = timepoint, y = mean, group = intervention_group, linetype = intervention_group)) + 
  geom_line() +
  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd)) +
  scale_y_continuous(limits = c(35, 60)) +
  scale_linetype_manual(name = "", values = c("solid", "dashed"), labels = c("HIIT - High Intensity Interval Training Group", "EDU - Educational Intervention Group")) +
   scale_x_discrete(labels = c( pre ="Before the intervention\n(II Trimester of Pregnancy)", post = "After the Intervention\n(III Trimester of Pregnancy)", postnatal = "Follow Up\n(± 5 Moths Postpartum)"))+
  xlab(bold("Physical Health") ~ "(measured with the Short Form Health Survey - physical subscale") +
    theme(legend.position = "bottom")

#Improved Graph Code for Figure 5
figure_5_graph_improved <- figure_5_data %>% 
  ggplot(aes(x = timepoint, y = mean, group = intervention_group, colour = intervention_group)) + 
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd), position = position_dodge(width = 0.1)) +
  scale_y_continuous(limits = c(35, 60)) +
  scale_linetype_manual(name = "", values = c("solid", "dashed"), labels = c("HIIT - High Intensity Interval Training Group", "EDU - Educational Intervention Group")) +
 scale_x_discrete(labels = c( pre ="Before the intervention\n(II Trimester of Pregnancy)", post = "After the Intervention\n(III Trimester of Pregnancy)", postnatal = "Follow Up\n(± 5 Moths Postpartum)"))+
  geom_text(aes(label = round(mean, 2))) +
  theme(legend.position = "bottom") 
  

figure_5_graph_original

figure_5_graph_improved


figure_5_graph_original + figure_5_graph_improved


  filter(!is.na(pre_sf_12_pcs_physicalhealthscale) & (!is.na(post_sf12_pcs) | !is.na(postnatal_sf_12_pcs)))


figure_5_graph_Improved <- figure_5_data %>% 
  ggplot(aes(x = timepoint, y = mean, group = intervention_group, linetype = intervention_group)) + 
  geom_line() +
  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd), position = position_dodge(width = 0.1)) +   #added position dodge
  scale_y_continuous(limits = c(35, 60)) +
  scale_linetype_manual(name = "", values = c("solid", "dotted"), labels = c("HIIT - High Intensity Interval Training Group", "EDU - Educational Intervention Group")) +
  scale_x_discrete(labels = c( pre ="Before the intervention\n(II Trimester of Pregnancy)", post = "After the Intervention\n(III Trimester of Pregnancy)", postnatal = "Follow Up\n(± 5 Moths Postpartum)"))+
  xlab(bold("Physical Health") ~ "(measured with the Short Form Health Survey - physical subscale") +
  geom_text(aes(label = round(mean, 2))) +
  geom_point() +   #added geom point
theme(legend.position = "bottom")

```


## Task 2: FAIR data principles

## Task 3: Reproducibility brief
